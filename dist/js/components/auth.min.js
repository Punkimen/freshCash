var appData={};const swal_log=Swal.mixin({title:"",text:"",showCancelButton:!1,showConfirmButton:!1}),swal_msg=Swal.mixin({title:"",text:"",showCancelButton:!1,showConfirmButton:!1});function check_auth(t="",o){o?window.location=t:(appData.next_url=t,show_full_login_wiget())}function login_full(){url="/auth/full_login/",tel_val=$("#phone").val(),appData.phone=tel_val;var t=new FormData;t.append("csrfmiddlewaretoken",window.CSRF_TOKEN),t.append("phone",tel_val),$.ajax({url:url,type:"POST",data:t,success:function(t){appData.token_html=t,swal_log.close(),swal_log.fire({title:"",text:"",html:appData.token_html,showCancelButton:!1,showConfirmButton:!1})},error:function(t){},cache:!1,contentType:!1,processData:!1})}function login_full_code_sand(){url="auth/api/login/"+appData.phone+"/",password=$("#token").val();let t=new FormData;t.append("csrfmiddlewaretoken",window.CSRF_TOKEN),t.append("token",password),$.ajax({url:url,type:"POST",data:t,success:function(t){console.log(t),swal_log.close(),"ok"===t.status?swal_msg.fire({title:"Логин",text:t.msg,timer:1e3,icon:"success",iconColor:"#8be835",willClose:()=>{window.location=appData.next_url},showCancelButton:!1,showConfirmButton:!1}):"error"===t.status&&swal_msg.fire({title:"Логин",text:t.msg,icon:"error",iconColor:"#db1919",timer:1e3,showCancelButton:!1,showConfirmButton:!1,willClose:()=>{swal_log.fire({title:"",text:"",html:appData.token_html,showCancelButton:!1,showConfirmButton:!1})}})},error:function(t){},cache:!1,contentType:!1,processData:!1})}function show_full_login_wiget(){$.ajax({url:"/auth/full_login/",type:"GET",async:!1,success:function(t){swal_log.close(),appData.phone_html=t,swal_log.fire({title:"",text:"",html:appData.phone_html,showCancelButton:!1,showConfirmButton:!1})},error:function(t){},cache:!1,contentType:!1,processData:!1})}"OTPCredential"in window&&window.addEventListener("DOMContentLoaded",t=>{const o=document.querySelector('input[autocomplete="one-time-code"]');o&&navigator.credentials.get({otp:{transport:["sms"]}}).then(t=>{o.value=t.code}).catch(t=>{console.log(t)})});